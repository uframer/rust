# ç»“æ„ä½“

å¯ä»¥ç”¨`struct`åˆ›å»ºå¤æ‚æ•°æ®ç±»å‹ã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬è¦åšäºŒç»´ç©ºé—´çš„å‡ ä½•è¿ç®—ï¼Œæˆ‘ä»¬éœ€è¦`x`åæ ‡å’Œ`y`åæ ‡çš„å€¼ï¼š

```rust
let origin_x = 0;
let origin_y = 0;
```

å¯ä»¥ç”¨`struct`å°†è¿™ä¸¤ä¸ªå˜é‡ç»„åˆåœ¨ä¸€èµ·ï¼š

```rust
struct Point {
    x: i32,
    y: i32,
}

fn main() {
    let origin = Point { x: 0, y: 0 }; // origin: Point

    println!("The origin is at ({}, {})", origin.x, origin.y);
}
```

æŒ‰ç…§çº¦å®šï¼Œ`struct`ç±»å‹çš„åå­—åº”è¯¥é‡‡ç”¨é©¼å³°å‘½åæ³•ï¼Œä¾‹å¦‚ï¼š`PointInSpace`ã€‚

æˆ‘ä»¬å¯ä»¥ç”¨`let`åˆ›å»º`struct`çš„å®ä¾‹ï¼Œå¹¶ç”¨`é”®:å€¼`å¯¹çš„é£æ ¼åˆå§‹åŒ–æ¯ä¸ªå­—æ®µã€‚åˆå§‹åŒ–å­—æ®µçš„é¡ºåºä¸ä¸€å®šè¦åŒå£°æ˜æ—¶çš„é¡ºåºä¸€æ ·ã€‚

å­—æ®µé€šè¿‡`.`æ¥è®¿é—®ï¼Œä¾‹å¦‚`origin.x`ã€‚

é»˜è®¤æƒ…å†µä¸‹ï¼Œ`struct`ä¸­çš„å€¼æ˜¯ä¸å¯å˜çš„ã€‚å¯ä»¥ä½¿ç”¨`mut`å£°æ˜å¯å˜çš„`struct`ï¼š

```rust
struct Point {
    x: i32,
    y: i32,
}

fn main() {
    let mut point = Point { x: 0, y: 0 };

    point.x = 5;

    println!("The point is at ({}, {})", point.x, point.y);
}
```

ä¸Šé¢çš„ç¨‹åºä¼šè¾“å‡ºï¼š`The point is at (5, 0)`ã€‚

åœ¨è¯­è¨€çº§åˆ«ï¼ŒRustä¸æ”¯æŒå•ç‹¬å®šä¹‰å­—æ®µçš„å¯å˜æ€§ï¼Œæ‰€ä»¥ä½ ä¸èƒ½è¿™ä¹ˆå†™ï¼š

```rust,ignore
struct Point {
    mut x: i32, // è¿™è¡Œä¼šé€ æˆç¼–è¯‘é”™è¯¯ã€‚
    y: i32,
}
```

å¯å˜æ€§æ˜¯ç»‘å®šçš„å±æ€§ï¼Œä¸æ˜¯ç»“æ„ä½“çš„å±æ€§ã€‚å¦‚æœä½ ä¹ æƒ¯äº†å­—æ®µçº§åˆ«çš„å¯å˜æ€§çº¦æŸï¼Œå¯èƒ½ä¼šä¸å¤ªé€‚åº”ï¼Œä½†æ˜¯Rustçš„è®¾è®¡å¯ä»¥ç®€åŒ–å¾ˆå¤šäº‹æƒ…ã€‚ä½ ç”šè‡³å¯ä»¥ä¸´æ—¶æ”¹å˜ä¸€ä¸ªç»‘å®šçš„å¯å˜æ€§ï¼š

```rust,ignore
struct Point {
    x: i32,
    y: i32,
}

fn main() {
    let mut point = Point { x: 0, y: 0 };

    point.x = 5;

    let point = point; // `point`ç°åœ¨æ˜¯ä¸å¯å˜çš„ã€‚

    point.y = 6; // è¿™è¡Œä¼šé€ æˆç¼–è¯‘é”™è¯¯ã€‚
}
```

ä¸è¿‡ï¼Œä½ çš„ç»“æ„ä½“å¯ä»¥åŒ…å«`&mut`æŒ‡é’ˆï¼Œè¿™æ ·å°±å¯ä»¥å®ç°æŸç§ç¨‹åº¦ä¸Šçš„å¯å˜æ€§ï¼š

```rust
struct Point {
    x: i32,
    y: i32,
}

struct PointRef<'a> {
    x: &'a mut i32,
    y: &'a mut i32,
}

fn main() {
    let mut point = Point { x: 0, y: 0 };

    {
        let r = PointRef { x: &mut point.x, y: &mut point.y };

        *r.x = 5;
        *r.y = 6;
    }

    assert_eq!(5, point.x);
    assert_eq!(6, point.y);
}
```

å¦‚æœåˆå§‹åŒ–æ‰€ç”¨å‚æ•°çš„å˜é‡ååŒå­—æ®µçš„åå­—æ˜¯ä¸€æ ·çš„è¯ï¼Œå¯ä»¥ç®€åŒ–æ•°æ®ç»“æ„åˆå§‹åŒ–ï¼ˆ`struct`ã€`enum`ã€`union`ï¼‰çš„å†™æ³•ã€‚æ³¨æ„ä¸‹é¢ä¾‹å­ä¸­çš„`name`å’Œ`age`ï¼š

```rust
#[derive(Debug)]
struct Person<'a> {
    name: &'a str,
    age: u8
}

fn main() {
    // ä½¿ç”¨ç®€åŒ–å†™æ³•åˆå§‹åŒ–ç»“æ„ä½“
    let name = "Peter";
    let age = 27;
    let peter = Person { name, age };

    // ç”¨Debugçš„åŠŸèƒ½æ‰“å°è¿™ä¸ªç»“æ„ä½“
    println!("{:?}", peter);
}
```

> ğŸ·ï¼šè¿™ä¸ªç®€åŒ–çš„å†™æ³•ç°åœ¨éœ€è¦`unstable`çš„ç¼–è¯‘å™¨ã€‚

# æ›´æ–°è¯­æ³•

`struct`å¯ä»¥åŒ…å«`..`å…³é”®å­—æ¥è¡¨ç¤ºä½ å¸Œæœ›ä»å¦ä¸€ä¸ª`struct`æ¥å¤åˆ¶æŸäº›å€¼ï¼š

```rust
struct Point3d {
    x: i32,
    y: i32,
    z: i32,
}

let mut point = Point3d { x: 0, y: 0, z: 0 };
point = Point3d { y: 1, .. point };
```

ä¸Šé¢çš„ä»£ç ä¼šç»™`point`çš„`y`å­—æ®µèµ‹ä¸€ä¸ªæ–°çš„å€¼ï¼ŒåŒæ—¶ç»´æŒ`x`å’Œ`z`çš„å€¼ä¸å˜ã€‚åœ¨è¿™ä¸ªä¾‹å­é‡Œï¼Œ`..`ä½œç”¨äºåŒä¸€ä¸ª`stuct`ï¼Œä½†æ˜¯å®ƒå¯ä»¥åº”ç”¨äºä¸åŒçš„`struct`ï¼Œæ­¤æ—¶ä¼šä»æ—§çš„`stuct`å¤åˆ¶åŸæœ‰çš„å€¼ï¼š

```rust
# struct Point3d {
#     x: i32,
#     y: i32,
#     z: i32,
# }
let origin = Point3d { x: 0, y: 0, z: 0 };
let point = Point3d { z: 1, x: 2, .. origin };
```

# å…ƒç»„ç»“æ„ä½“

Rustçš„ *å…ƒç»„ç»“æ„ä½“* å°±åƒæ˜¯[å…ƒç»„][tuple]å’Œ`struct`çš„æ··åˆä½“ã€‚å…ƒç»„ç»“æ„ä½“æœ‰ä¸€ä¸ªåå­—ï¼Œä½†æ˜¯å®ƒçš„å­—æ®µæ²¡æœ‰åå­—ã€‚å®ƒä»¬ä¹Ÿç”¨`struct`å…³é”®å­—å£°æ˜ï¼Œä½†æ˜¯åå­—åé¢è·Ÿç€çš„æ˜¯ä¸€ä¸ªå…ƒç»„ï¼š

```rust
struct Color(i32, i32, i32);
struct Point(i32, i32, i32);

let black = Color(0, 0, 0);
let origin = Point(0, 0, 0);
```


å¯ä»¥é€šè¿‡`.`æ¥è®¿é—®å…ƒç»„ç»“æ„ä½“çš„æˆå‘˜ï¼Œä¹Ÿå¯ä»¥é€šè¿‡æ‰€è°“çš„destructuring
`let`è¯­æ³•æ¥è®¿é—®ï¼Œå°±å¦‚åŒæ™®é€šçš„å…ƒç»„ä¸€æ ·ï¼š

```rust
# struct Color(i32, i32, i32);
# struct Point(i32, i32, i32);
# let black = Color(0, 0, 0);
# let origin = Point(0, 0, 0);
let black_r = black.0;
let Point(_, origin_y, origin_z) = origin;
```

[matchè¡¨è¾¾å¼][match]ä¸­ä¹Ÿä¼šç”¨åˆ°å½¢å¦‚`Point(_, origin_y, origin_z)`çš„æ¨¡å¼ã€‚

ä¸€ä¸ªèƒ½è®©å…ƒç»„ç»“æ„ä½“å¤§å±•æ‹³è„šçš„åœºæ™¯æ˜¯å½“å®ƒåªå«æœ‰ä¸€ä¸ªå…ƒç´ çš„æ—¶å€™ã€‚æˆ‘ä»¬æŠŠè¿™ç§ç”¨æ³•æˆä¸º *newtype* æ¨¡å¼ï¼Œå› ä¸ºä½ å¯ä»¥åœ¨ä¿æŒåŸæœ‰å€¼çš„è¯­ä¹‰çš„æƒ…å†µä¸‹åˆ›å»ºä¸€ä¸ªæ–°çš„ç±»å‹ï¼š

```rust
struct Inches(i32);

let length = Inches(10);

let Inches(integer_length) = length;
println!("length is {} inches", integer_length);
```

å¦‚åŒä¸Šé¢çš„ä¾‹å­ï¼Œä½ å¯ä»¥é€šè¿‡æ‰€è°“çš„ *ææ„* `let`æ¥åŒ¹é…å¾—åˆ°çœŸæ­£çš„å€¼ï¼š`let Inches(integer_length)`ä¼šæŠŠ`10`èµ‹å€¼ç»™`integer_length`ã€‚æˆ‘ä»¬ä¹Ÿå¯ä»¥ç”¨ç‚¹è¯­æ³•è·å–æ•°å€¼ï¼š

```rust
# struct Inches(i32);
# let length = Inches(10);
let integer_length = length.0;
```

æ‰€æœ‰ä½¿ç”¨å…ƒç»„ç»“æ„ä½“çš„åœºæ™¯ä¸‹ï¼Œä½ éƒ½å¯ä»¥ç”¨`struct`æ›¿ä»£å…ƒç»„ç»“æ„ä½“ï¼Œè€Œä¸”ä¹Ÿä¼šæ›´ä¸ºæ¸…æ™°ã€‚æˆ‘ä»¬çš„`Color`å’Œ`Point`å¯ä»¥å†™æˆè¿™æ ·ï¼š

```rust
struct Color {
    red: i32,
    blue: i32,
    green: i32,
}

struct Point {
    x: i32,
    y: i32,
    z: i32,
}
```

ç»™å­—æ®µèµ·ä¸€ä¸ªå¥½åå­—æ˜¯å¾ˆé‡è¦çš„äº‹æƒ…ï¼Œå°½ç®¡å…ƒç»„ç»“æ„ä½“çš„æˆå‘˜å¯ä»¥é€šè¿‡ç‚¹è¯­æ³•è®¿é—®ï¼Œå´ä¸å¯èƒ½åƒ`struct`é‚£æ ·ç»™æ¯ä¸ªå­—æ®µä¸€ä¸ªæ¸…æ™°çš„åå­—ã€‚

[match]: match.html

# å•å…ƒç»“æ„ä½“ï¼ˆunit-like `struct`ï¼‰

ä½ å¯ä»¥å®šä¹‰ä¸€ä¸ªæ²¡æœ‰ä»»ä½•æˆå‘˜çš„ç»“æ„ä½“`struct`ï¼š

```rust
struct Electron {} // åªæœ‰ä¸¤ä¸ªå¤§æ‹¬å·...
struct Proton;     // ...æˆ–è€…ç›´æ¥è·Ÿç€ä¸€ä¸ªåˆ†å·ã€‚

// ä¸è®ºä½ å£°æ˜ç»“æ„ä½“æ—¶ç”¨çš„æ˜¯ä¸Šé¢é‚£ç§å†™æ³•ï¼Œåˆ›å»ºå®ƒçš„å®ä¾‹çš„æ—¶å€™è¦ä½¿ç”¨åŒå£°æ˜ä¸€æ ·çš„è§£æ³•ã€‚
let x = Electron {};
let y = Proton;
```

ä¹‹æ‰€ä»¥æŠŠè¿™ç§`struct`ç§°ä½œ *å•å…ƒç»“æ„ä½“* ï¼Œæ˜¯å› ä¸ºå®ƒåŒç©ºå…ƒç»„`()`å¾ˆåƒï¼Œè€Œç©ºå…ƒç»„æœ‰ä¸ªåˆ«åå°±å«åš *å•å…ƒ* ã€‚åŒå…ƒç»„ç»“æ„ä½“ä¸€æ ·ï¼Œå®ƒä¹Ÿå®šä¹‰äº†ä¸€ç§æ–°çš„ç±»å‹ã€‚

è¿™ä¸ªå†™æ³•æœ¬èº«å¹¶æ²¡æœ‰å¤ªå¤šç”¨å¤„ï¼ˆå°½ç®¡æœ‰æ—¶å€™å¯ä»¥æŠŠå®ƒå½“åšæ ‡è®°ç±»å‹ï¼‰ï¼Œé€šå¸¸éœ€è¦å’Œåˆ«çš„è¯­è¨€ç‰¹æ€§ç»“åˆä½¿ç”¨ã€‚ä¾‹å¦‚ï¼Œä¸€ä¸ªåº“å¯èƒ½è¦æ±‚ä½ åˆ›å»ºä¸€ä¸ªå®ç°äº†ç‰¹å®š[ç‰¹å¾][trait]çš„ç»“æ„ä½“æ¥å¤„ç†äº‹ä»¶ï¼ˆğŸ·ï¼šç±»ä¼¼äºåˆ«çš„è¯­è¨€ä¸­Callback Handlerçš„æ¦‚å¿µï¼‰ã€‚å¦‚æœä½ å¹¶ä¸éœ€è¦åœ¨ç»“æ„ä½“ä¸­ä¿å­˜ä»»ä½•æ•°æ®çš„è¯ï¼Œå°±å¯ä»¥ä½¿ç”¨å•å…ƒç»“æ„ä½“ã€‚

[trait]: traits.html
